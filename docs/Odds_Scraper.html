
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[178]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c"># import socket</span>
<span class="c"># fimport socks</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="k">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">date</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="k">import</span> <span class="n">DataFrame</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">psycopg2</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="k">import</span> <span class="n">pprint</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="k">import</span> <span class="n">create_engine</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[185]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c"># def connectTor():</span>
<span class="c">#   ## Connect to Tor for privacy purposes</span>
<span class="c">#      socks.setdefaultproxy(socks.PROXY_TYPE_SOCKS5, &#39;127.0.0.1&#39;, 9150, True)</span>
<span class="c">#      socket.socket = socks.socksocket</span>
<span class="c">#      print &quot;connected to Tor!&quot;</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[186]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">parse_and_write_data</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
<span class="c">## Parse HTML to gather line data by book</span>
    <span class="k">def</span> <span class="nf">book_line</span><span class="p">(</span><span class="n">book_id</span><span class="p">,</span> <span class="n">line_id</span><span class="p">,</span> <span class="n">homeaway</span><span class="p">):</span>
        <span class="c">## Get Line info from book ID</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">&#39;div&#39;</span><span class="p">,</span> <span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;class&#39;</span><span class="p">:</span><span class="s">&#39;el-div eventLine-book&#39;</span><span class="p">,</span> <span class="s">&#39;rel&#39;</span><span class="p">:</span><span class="n">book_id</span><span class="p">})[</span><span class="n">line_id</span><span class="p">]</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">&#39;div&#39;</span><span class="p">)[</span><span class="n">homeaway</span><span class="p">]</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">line</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    BookID  BookName</span>
<span class="sd">    238     Pinnacle</span>
<span class="sd">    93      BookMaker</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">columns</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;key&#39;</span><span class="p">,</span><span class="s">&#39;game_id&#39;</span><span class="p">,</span><span class="s">&#39;game_date&#39;</span><span class="p">,</span><span class="s">&#39;scrape_time&#39;</span><span class="p">,</span><span class="s">&#39;team&#39;</span><span class="p">,</span><span class="s">&#39;opp_team&#39;</span><span class="p">,</span><span class="s">&#39;line&#39;</span><span class="p">,</span><span class="s">&#39;odds&#39;</span><span class="p">))</span>

    <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">number_of_games</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">&#39;div&#39;</span><span class="p">,</span> <span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;class&#39;</span><span class="p">:</span><span class="s">&#39;el-div eventLine-rotation&#39;</span><span class="p">}))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">number_of_games</span><span class="p">):</span>
        <span class="n">A</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">H</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c"># print(str(i+1)+&#39;/&#39;+str(number_of_games))</span>
        <span class="c">## Gather all useful data from unique books</span>
        <span class="n">info_A</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">&#39;div&#39;</span><span class="p">,</span> <span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;class&#39;</span><span class="p">:</span><span class="s">&#39;el-div eventLine-team&#39;</span><span class="p">})[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">&#39;div&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">team_A</span> <span class="o">=</span> <span class="n">info_A</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">away</span> <span class="o">=</span> 	    <span class="n">book_line</span><span class="p">(</span><span class="s">&#39;93&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="n">away</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="n">info_H</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">&#39;div&#39;</span><span class="p">,</span> <span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;class&#39;</span><span class="p">:</span><span class="s">&#39;el-div eventLine-team&#39;</span><span class="p">})[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">&#39;div&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">team_H</span> <span class="o">=</span> <span class="n">info_H</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">home</span> <span class="o">=</span> 	    <span class="n">book_line</span><span class="p">(</span><span class="s">&#39;93&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="n">home</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">team_H</span> <span class="o">==</span>   <span class="s">&#39;Detroit&#39;</span><span class="p">:</span>
            <span class="n">team_H</span> <span class="o">=</span>   <span class="s">&#39;Detroit&#39;</span>
        <span class="k">elif</span> <span class="n">team_H</span> <span class="o">==</span> <span class="s">&#39;Indiana&#39;</span><span class="p">:</span>
            <span class="n">team_H</span> <span class="o">=</span>   <span class="s">&#39;Indiana&#39;</span>
        <span class="k">elif</span> <span class="n">team_H</span> <span class="o">==</span> <span class="s">&#39;Brooklyn&#39;</span><span class="p">:</span>
            <span class="n">team_H</span> <span class="o">=</span>   <span class="s">&#39;Brooklyn&#39;</span>
        <span class="k">elif</span> <span class="n">team_H</span> <span class="o">==</span> <span class="s">&#39;L.A. Lakers&#39;</span><span class="p">:</span>
            <span class="n">team_H</span> <span class="o">=</span>   <span class="s">&#39;L.A. Lakers&#39;</span>
        <span class="k">elif</span> <span class="n">team_H</span> <span class="o">==</span> <span class="s">&#39;Washington&#39;</span><span class="p">:</span>
            <span class="n">team_H</span> <span class="o">=</span>   <span class="s">&#39;Washington&#39;</span>
        <span class="k">elif</span> <span class="n">team_H</span> <span class="o">==</span> <span class="s">&#39;Miami&#39;</span><span class="p">:</span>
            <span class="n">team_H</span> <span class="o">=</span>   <span class="s">&#39;Miami&#39;</span>
        <span class="k">elif</span> <span class="n">team_H</span> <span class="o">==</span> <span class="s">&#39;Minnesota&#39;</span><span class="p">:</span>
            <span class="n">team_H</span> <span class="o">=</span>   <span class="s">&#39;Minnesota&#39;</span>
        <span class="k">elif</span> <span class="n">team_H</span> <span class="o">==</span> <span class="s">&#39;Chicago&#39;</span><span class="p">:</span>
            <span class="n">team_H</span> <span class="o">=</span>   <span class="s">&#39;Chicago&#39;</span>
        <span class="k">elif</span> <span class="n">team_H</span> <span class="o">==</span> <span class="s">&#39;Oklahoma City&#39;</span><span class="p">:</span>
            <span class="n">team_H</span> <span class="o">=</span>   <span class="s">&#39;Oklahoma City&#39;</span>
        <span class="k">if</span> <span class="n">team_A</span> <span class="o">==</span>   <span class="s">&#39;New Orleans&#39;</span><span class="p">:</span>
            <span class="n">team_A</span> <span class="o">=</span>   <span class="s">&#39;New Orleans&#39;</span>
        <span class="k">elif</span> <span class="n">team_A</span> <span class="o">==</span> <span class="s">&#39;Houston&#39;</span><span class="p">:</span>
            <span class="n">team_A</span> <span class="o">=</span>   <span class="s">&#39;Houston&#39;</span>
        <span class="k">elif</span> <span class="n">team_A</span> <span class="o">==</span> <span class="s">&#39;Dallas&#39;</span><span class="p">:</span>
            <span class="n">team_A</span> <span class="o">=</span>   <span class="s">&#39;Dallas&#39;</span>
        <span class="k">elif</span> <span class="n">team_A</span> <span class="o">==</span> <span class="s">&#39;Cleveland&#39;</span><span class="p">:</span>
            <span class="n">team_A</span> <span class="o">=</span>   <span class="s">&#39;Cleveland&#39;</span>
        <span class="k">elif</span> <span class="n">team_A</span> <span class="o">==</span> <span class="s">&#39;L.A. Clippers&#39;</span><span class="p">:</span>
            <span class="n">team_A</span> <span class="o">=</span>   <span class="s">&#39;L.A. Clippers&#39;</span>
        <span class="k">elif</span> <span class="n">team_A</span> <span class="o">==</span> <span class="s">&#39;Golden State&#39;</span><span class="p">:</span>
            <span class="n">team_A</span> <span class="o">=</span>   <span class="s">&#39;Golden State&#39;</span>
        <span class="k">elif</span> <span class="n">team_A</span> <span class="o">==</span> <span class="s">&#39;Denver&#39;</span><span class="p">:</span>
            <span class="n">team_A</span> <span class="o">=</span>   <span class="s">&#39;Denver&#39;</span>
        <span class="k">elif</span> <span class="n">team_A</span> <span class="o">==</span> <span class="s">&#39;Boston&#39;</span><span class="p">:</span>
            <span class="n">team_A</span> <span class="o">=</span>   <span class="s">&#39;Boston&#39;</span>
        <span class="k">elif</span> <span class="n">team_A</span> <span class="o">==</span> <span class="s">&#39;Milwaukee&#39;</span><span class="p">:</span>
            <span class="n">team_A</span> <span class="o">=</span>   <span class="s">&#39;Milwaukee&#39;</span>             

        <span class="n">A</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">date</span><span class="o">+</span><span class="s">&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;A&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="p">))</span>
        <span class="n">A</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">date</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="n">A</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
        <span class="n">A</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="n">A</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">team_A</span><span class="p">)</span>
        <span class="n">A</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">team_H</span><span class="p">)</span>

        <span class="n">away</span> <span class="o">=</span> <span class="n">away</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">u&#39;</span><span class="se">\xa0</span><span class="s">&#39;</span><span class="p">,</span><span class="s">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">u&#39;</span><span class="se">\xbd</span><span class="s">&#39;</span><span class="p">,</span><span class="s">&#39;.5&#39;</span><span class="p">)</span>
        <span class="n">away_line</span> <span class="o">=</span> <span class="n">away</span><span class="p">[:</span><span class="n">away</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)]</span>
        <span class="n">away_odds</span> <span class="o">=</span> <span class="n">away</span><span class="p">[</span><span class="n">away</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span>
        <span class="n">A</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">away_line</span><span class="p">)</span>
        <span class="n">A</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">away_odds</span><span class="p">)</span>


        <span class="n">H</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">date</span><span class="o">+</span><span class="s">&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;H&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="p">))</span>
        <span class="n">H</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">date</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="n">H</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
        <span class="n">H</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="n">H</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">team_H</span><span class="p">)</span>
        <span class="n">H</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">team_A</span><span class="p">)</span>
        
        <span class="n">home</span> <span class="o">=</span> <span class="n">home</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">u&#39;</span><span class="se">\xa0</span><span class="s">&#39;</span><span class="p">,</span><span class="s">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">u&#39;</span><span class="se">\xbd</span><span class="s">&#39;</span><span class="p">,</span><span class="s">&#39;.5&#39;</span><span class="p">)</span>
        <span class="n">home_line</span> <span class="o">=</span> <span class="n">home</span><span class="p">[:</span><span class="n">home</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)]</span>
        <span class="n">home_odds</span> <span class="o">=</span> <span class="n">home</span><span class="p">[</span><span class="n">home</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span>
        <span class="n">H</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">home_line</span><span class="p">)</span>
        <span class="n">H</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">home_odds</span><span class="p">)</span>

        <span class="c">## Take data from A and H (lists) and put them into DataFrame</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">counter</span><span class="p">]</span>   <span class="o">=</span> <span class="p">([</span><span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">))])</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">counter</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">([</span><span class="n">H</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">H</span><span class="p">))])</span>
        <span class="n">counter</span> <span class="o">+=</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[187]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">soup_url</span><span class="p">(</span><span class="n">type_of_line</span><span class="p">,</span> <span class="n">tdate</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">())</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;-&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">)):</span>
<span class="c">## get html code for odds based on desired line type and date</span>
    <span class="k">if</span> <span class="n">type_of_line</span> <span class="o">==</span> <span class="s">&#39;Spreads&#39;</span><span class="p">:</span>
        <span class="n">url_addon</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
    <span class="k">elif</span> <span class="n">type_of_line</span> <span class="o">==</span> <span class="s">&#39;Totals&#39;</span><span class="p">:</span>
        <span class="n">url_addon</span> <span class="o">=</span> <span class="s">&#39;totals/&#39;</span>
    <span class="k">elif</span> <span class="n">type_of_line</span> <span class="o">==</span> <span class="s">&#39;1HSpread&#39;</span><span class="p">:</span>
        <span class="n">url_addon</span> <span class="o">=</span> <span class="s">&#39;1st-half/&#39;</span>
    <span class="k">elif</span> <span class="n">type_of_line</span> <span class="o">==</span> <span class="s">&#39;1HTotal&#39;</span><span class="p">:</span>
        <span class="n">url_addon</span> <span class="o">=</span> <span class="s">&#39;totals/1st-half/&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s">&quot;Wrong url_addon&quot;</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s">&#39;http://www.sportsbookreview.com/betting-odds/nba-basketball/&#39;</span> <span class="o">+</span> <span class="n">url_addon</span> <span class="o">+</span> <span class="s">&#39;?date=&#39;</span> <span class="o">+</span> <span class="n">tdate</span>
    <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="n">raw_data</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">soup_big</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">raw_data</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s">&#39;html.parser&#39;</span><span class="p">)</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">soup_big</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">&#39;div&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="s">&#39;OddsGridModule_5&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;%H:%M:%S&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">soup</span><span class="p">,</span> <span class="n">timestamp</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[188]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">select_and_rename</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
    <span class="c">## Select only useful column names from a DataFrame</span>
    <span class="c">## Rename column names so that when merged, each df will be unique </span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s">&#39;key&#39;</span><span class="p">,</span><span class="s">&#39;game_id&#39;</span><span class="p">,</span><span class="s">&#39;game_date&#39;</span><span class="p">,</span><span class="s">&#39;scrape_time&#39;</span><span class="p">,</span><span class="s">&#39;team&#39;</span><span class="p">,</span><span class="s">&#39;opp_team&#39;</span><span class="p">,</span><span class="s">&#39;line&#39;</span><span class="p">,</span><span class="s">&#39;odds&#39;</span><span class="p">]]</span>

    <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;key&#39;</span><span class="p">,</span><span class="s">&#39;game_id&#39;</span><span class="p">,</span><span class="s">&#39;game_date&#39;</span><span class="p">,</span><span class="s">&#39;scrape_time&#39;</span><span class="p">,</span><span class="s">&#39;team&#39;</span><span class="p">,</span><span class="s">&#39;opp_team&#39;</span><span class="p">,</span><span class="n">text</span><span class="o">+</span><span class="s">&#39;_line&#39;</span><span class="p">,</span><span class="n">text</span><span class="o">+</span><span class="s">&#39;_odds&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[194]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">time_rl</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[194]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&apos;19:18:46&apos;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[201]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c"># connectTor()</span>

<span class="c">## Get today&#39;s lines</span>
<span class="n">todays_date</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">())</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;-&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">)</span>
<span class="c">## change todays_date to be whatever date you want to pull in the format &#39;yyyymmdd&#39;</span>
<span class="c">## One could force user input and if results in blank, revert to today&#39;s date. </span>
<span class="c"># todays_date = &#39;20140611&#39;</span>

<span class="c">## store BeautifulSoup info for parsing</span>
<span class="n">soup_rl</span><span class="p">,</span> <span class="n">time_rl</span> <span class="o">=</span> <span class="n">soup_url</span><span class="p">(</span><span class="s">&#39;Spreads&#39;</span><span class="p">,</span> <span class="n">todays_date</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s">&quot;Scraping Spreads (1/4)&quot;</span><span class="p">)</span>
<span class="n">soup_tot</span><span class="p">,</span> <span class="n">time_tot</span> <span class="o">=</span> <span class="n">soup_url</span><span class="p">(</span><span class="s">&#39;Totals&#39;</span><span class="p">,</span> <span class="n">todays_date</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s">&quot;Scraping Totals (2/4)&quot;</span><span class="p">)</span>
<span class="n">soup_1h_rl</span><span class="p">,</span> <span class="n">time_1h_rl</span> <span class="o">=</span> <span class="n">soup_url</span><span class="p">(</span><span class="s">&#39;1HSpread&#39;</span><span class="p">,</span> <span class="n">todays_date</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s">&quot;Scraping 1H Spreads (3/4)&quot;</span><span class="p">)</span>
<span class="n">soup_1h_tot</span><span class="p">,</span> <span class="n">time_1h_tot</span> <span class="o">=</span> <span class="n">soup_url</span><span class="p">(</span><span class="s">&#39;1HTotal&#39;</span><span class="p">,</span> <span class="n">todays_date</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s">&quot;Scraping 1H Totals (4/4)&quot;</span><span class="p">)</span>


<span class="c">#### Each df_xx creates a data frame for a bet type</span>
<span class="nb">print</span><span class="p">(</span><span class="s">&quot;Logging Spreads (1/4)&quot;</span><span class="p">)</span>
<span class="n">df_rl</span> <span class="o">=</span> <span class="n">parse_and_write_data</span><span class="p">(</span><span class="n">soup_rl</span><span class="p">,</span> <span class="n">todays_date</span><span class="p">,</span> <span class="n">time_rl</span><span class="p">)</span>
<span class="n">df_rl</span> <span class="o">=</span> <span class="n">select_and_rename</span><span class="p">(</span><span class="n">df_rl</span><span class="p">,</span> <span class="s">&#39;spread&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s">&quot;Logging Totals (2/4)&quot;</span><span class="p">)</span>
<span class="n">df_tot</span> <span class="o">=</span> <span class="n">parse_and_write_data</span><span class="p">(</span><span class="n">soup_tot</span><span class="p">,</span> <span class="n">todays_date</span><span class="p">,</span> <span class="n">time_rl</span><span class="p">)</span>
<span class="n">df_tot</span> <span class="o">=</span> <span class="n">select_and_rename</span><span class="p">(</span><span class="n">df_tot</span><span class="p">,</span> <span class="s">&#39;total&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s">&quot;Logging 1H Spreads (3/4)&quot;</span><span class="p">)</span>
<span class="n">df_1h_rl</span> <span class="o">=</span> <span class="n">parse_and_write_data</span><span class="p">(</span><span class="n">soup_1h_rl</span><span class="p">,</span> <span class="n">todays_date</span><span class="p">,</span> <span class="n">time_rl</span><span class="p">)</span>
<span class="n">df_1h_rl</span> <span class="o">=</span> <span class="n">select_and_rename</span><span class="p">(</span><span class="n">df_1h_rl</span><span class="p">,</span> <span class="s">&#39;fh_spread&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s">&quot;Logging 1H Totals (4/4)&quot;</span><span class="p">)</span>
<span class="n">df_1h_tot</span> <span class="o">=</span> <span class="n">parse_and_write_data</span><span class="p">(</span><span class="n">soup_1h_tot</span><span class="p">,</span> <span class="n">todays_date</span><span class="p">,</span> <span class="n">time_rl</span><span class="p">)</span>
<span class="n">df_1h_tot</span> <span class="o">=</span> <span class="n">select_and_rename</span><span class="p">(</span><span class="n">df_1h_tot</span><span class="p">,</span> <span class="s">&#39;fh_total&#39;</span><span class="p">)</span>

<span class="c">## Merge all DataFrames together to allow for simple printout</span>
<span class="n">write_df</span> <span class="o">=</span> <span class="n">df_rl</span>
<span class="n">write_df</span> <span class="o">=</span> <span class="n">write_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
            <span class="n">df_tot</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;key&#39;</span><span class="p">,</span><span class="s">&#39;game_id&#39;</span><span class="p">,</span><span class="s">&#39;game_date&#39;</span><span class="p">,</span><span class="s">&#39;scrape_time&#39;</span><span class="p">,</span><span class="s">&#39;team&#39;</span><span class="p">,</span><span class="s">&#39;opp_team&#39;</span><span class="p">])</span>
<span class="n">write_df</span> <span class="o">=</span> <span class="n">write_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
            <span class="n">df_1h_rl</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;key&#39;</span><span class="p">,</span><span class="s">&#39;game_id&#39;</span><span class="p">,</span><span class="s">&#39;game_date&#39;</span><span class="p">,</span><span class="s">&#39;scrape_time&#39;</span><span class="p">,</span><span class="s">&#39;team&#39;</span><span class="p">,</span><span class="s">&#39;opp_team&#39;</span><span class="p">])</span>
<span class="n">write_df</span> <span class="o">=</span> <span class="n">write_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
            <span class="n">df_1h_tot</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;key&#39;</span><span class="p">,</span><span class="s">&#39;game_id&#39;</span><span class="p">,</span><span class="s">&#39;game_date&#39;</span><span class="p">,</span><span class="s">&#39;scrape_time&#39;</span><span class="p">,</span><span class="s">&#39;team&#39;</span><span class="p">,</span><span class="s">&#39;opp_team&#39;</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Scraping Spreads (1/4)
Scraping Totals (2/4)
Scraping 1H Spreads (3/4)
Scraping 1H Totals (4/4)
Logging Spreads (1/4)
Logging Totals (2/4)
Logging 1H Spreads (3/4)
Logging 1H Totals (4/4)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[202]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">write_df</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[202]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>game_id</th>
      <th>game_date</th>
      <th>scrape_time</th>
      <th>team</th>
      <th>opp_team</th>
      <th>spread_line</th>
      <th>spread_odds</th>
      <th>total_line</th>
      <th>total_odds</th>
      <th>fh_spread_line</th>
      <th>fh_spread_odds</th>
      <th>fh_total_line</th>
      <th>fh_total_odds</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>201711030A09:31:50</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:31:50</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1</th>
      <td>201711030H09:31:50</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:31:50</td>
      <td>Orlando</td>
      <td>Chicago</td>
      <td>-8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>-5</td>
      <td>-110</td>
      <td>103</td>
      <td>-105</td>
    </tr>
    <tr>
      <th>2</th>
      <td>201711031A09:31:50</td>
      <td>201711031</td>
      <td>20171103</td>
      <td>09:31:50</td>
      <td>Cleveland</td>
      <td>Washington</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>201711031H09:31:50</td>
      <td>201711031</td>
      <td>20171103</td>
      <td>09:31:50</td>
      <td>Washington</td>
      <td>Cleveland</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>201711032A09:31:50</td>
      <td>201711032</td>
      <td>20171103</td>
      <td>09:31:50</td>
      <td>Milwaukee</td>
      <td>Detroit</td>
      <td>+1.5</td>
      <td>-105</td>
      <td>205</td>
      <td>-110</td>
      <td>+.5</td>
      <td>-105</td>
      <td>105.5</td>
      <td>-105</td>
    </tr>
    <tr>
      <th>5</th>
      <td>201711032H09:31:50</td>
      <td>201711032</td>
      <td>20171103</td>
      <td>09:31:50</td>
      <td>Detroit</td>
      <td>Milwaukee</td>
      <td>-1.5</td>
      <td>-115</td>
      <td>205</td>
      <td>-110</td>
      <td>-.5</td>
      <td>-115</td>
      <td>105.5</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>6</th>
      <td>201711033A09:31:50</td>
      <td>201711033</td>
      <td>20171103</td>
      <td>09:31:50</td>
      <td>Indiana</td>
      <td>Philadelphia</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>7</th>
      <td>201711033H09:31:50</td>
      <td>201711033</td>
      <td>20171103</td>
      <td>09:31:50</td>
      <td>Philadelphia</td>
      <td>Indiana</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>8</th>
      <td>201711034A09:31:50</td>
      <td>201711034</td>
      <td>20171103</td>
      <td>09:31:50</td>
      <td>Phoenix</td>
      <td>New York</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>9</th>
      <td>201711034H09:31:50</td>
      <td>201711034</td>
      <td>20171103</td>
      <td>09:31:50</td>
      <td>New York</td>
      <td>Phoenix</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>10</th>
      <td>201711035A09:31:50</td>
      <td>201711035</td>
      <td>20171103</td>
      <td>09:31:50</td>
      <td>Houston</td>
      <td>Atlanta</td>
      <td>-8.5</td>
      <td>-110</td>
      <td>214</td>
      <td>-110</td>
      <td>-4.5</td>
      <td>-110</td>
      <td>111.5</td>
      <td>-110</td>
    </tr>
    <tr>
      <th>11</th>
      <td>201711035H09:31:50</td>
      <td>201711035</td>
      <td>20171103</td>
      <td>09:31:50</td>
      <td>Atlanta</td>
      <td>Houston</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>214</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>111.5</td>
      <td>-110</td>
    </tr>
    <tr>
      <th>12</th>
      <td>201711036A09:31:50</td>
      <td>201711036</td>
      <td>20171103</td>
      <td>09:31:50</td>
      <td>New Orleans</td>
      <td>Dallas</td>
      <td>-4.5</td>
      <td>-110</td>
      <td>211.5</td>
      <td>-110</td>
      <td>-2</td>
      <td>-105</td>
      <td>108.5</td>
      <td>-105</td>
    </tr>
    <tr>
      <th>13</th>
      <td>201711036H09:31:50</td>
      <td>201711036</td>
      <td>20171103</td>
      <td>09:31:50</td>
      <td>Dallas</td>
      <td>New Orleans</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>211.5</td>
      <td>-110</td>
      <td>+2</td>
      <td>-115</td>
      <td>108.5</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>14</th>
      <td>201711037A09:31:50</td>
      <td>201711037</td>
      <td>20171103</td>
      <td>09:31:50</td>
      <td>Charlotte</td>
      <td>San Antonio</td>
      <td>+3</td>
      <td>-110</td>
      <td>199</td>
      <td>-110</td>
      <td>+1.5</td>
      <td>-110</td>
      <td>103.5</td>
      <td>-110</td>
    </tr>
    <tr>
      <th>15</th>
      <td>201711037H09:31:50</td>
      <td>201711037</td>
      <td>20171103</td>
      <td>09:31:50</td>
      <td>San Antonio</td>
      <td>Charlotte</td>
      <td>-3</td>
      <td>-110</td>
      <td>199</td>
      <td>-110</td>
      <td>-1.5</td>
      <td>-110</td>
      <td>103.5</td>
      <td>-110</td>
    </tr>
    <tr>
      <th>16</th>
      <td>201711038A09:31:50</td>
      <td>201711038</td>
      <td>20171103</td>
      <td>09:31:50</td>
      <td>Miami</td>
      <td>Denver</td>
      <td>+5.5</td>
      <td>-105</td>
      <td>214</td>
      <td>-110</td>
      <td>+3</td>
      <td>-110</td>
      <td>108.5</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>17</th>
      <td>201711038H09:31:50</td>
      <td>201711038</td>
      <td>20171103</td>
      <td>09:31:50</td>
      <td>Denver</td>
      <td>Miami</td>
      <td>-5.5</td>
      <td>-115</td>
      <td>214</td>
      <td>-110</td>
      <td>-3</td>
      <td>-110</td>
      <td>108.5</td>
      <td>-105</td>
    </tr>
    <tr>
      <th>18</th>
      <td>201711039A09:31:50</td>
      <td>201711039</td>
      <td>20171103</td>
      <td>09:31:50</td>
      <td>Toronto</td>
      <td>Utah</td>
      <td>+1.5</td>
      <td>-110</td>
      <td>195</td>
      <td>-110</td>
      <td>+.5</td>
      <td>-110</td>
      <td>97</td>
      <td>-110</td>
    </tr>
    <tr>
      <th>19</th>
      <td>201711039H09:31:50</td>
      <td>201711039</td>
      <td>20171103</td>
      <td>09:31:50</td>
      <td>Utah</td>
      <td>Toronto</td>
      <td>-1.5</td>
      <td>-110</td>
      <td>195</td>
      <td>-110</td>
      <td>-.5</td>
      <td>-110</td>
      <td>97</td>
      <td>-110</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2017110310A09:31:50</td>
      <td>2017110310</td>
      <td>20171103</td>
      <td>09:31:50</td>
      <td>Boston</td>
      <td>Oklahoma City</td>
      <td>+6</td>
      <td>-110</td>
      <td>204.5</td>
      <td>-110</td>
      <td>+3</td>
      <td>-105</td>
      <td>98</td>
      <td>-105</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2017110310H09:31:50</td>
      <td>2017110310</td>
      <td>20171103</td>
      <td>09:31:50</td>
      <td>Oklahoma City</td>
      <td>Boston</td>
      <td>-6</td>
      <td>-110</td>
      <td>204.5</td>
      <td>-110</td>
      <td>-3</td>
      <td>-115</td>
      <td>98</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2017110311A09:31:50</td>
      <td>2017110311</td>
      <td>20171103</td>
      <td>09:31:50</td>
      <td>Brooklyn</td>
      <td>L.A. Lakers</td>
      <td>+2.5</td>
      <td>-110</td>
      <td>225</td>
      <td>-110</td>
      <td>+1</td>
      <td>-110</td>
      <td>108</td>
      <td>-110</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2017110311H09:31:50</td>
      <td>2017110311</td>
      <td>20171103</td>
      <td>09:31:50</td>
      <td>L.A. Lakers</td>
      <td>Brooklyn</td>
      <td>-2.5</td>
      <td>-110</td>
      <td>225</td>
      <td>-110</td>
      <td>-1</td>
      <td>-110</td>
      <td>108</td>
      <td>-110</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[180]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[183]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">timestamp</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;%H:%M:%S&quot;</span><span class="p">)</span>
<span class="n">timestamp</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[183]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&apos;19:18:07&apos;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[172]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">conn</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&quot;dbname=nba_lines user=colepage&quot;</span><span class="p">)</span>
<span class="n">conn</span><span class="o">.</span><span class="n">autocommit</span> <span class="o">=</span> <span class="k">True</span>
<span class="n">cur</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[173]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">run_command</span><span class="p">(</span><span class="n">command</span><span class="p">):</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cur</span><span class="o">.</span><span class="n">statusmessage</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[174]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s">&#39;postgresql://colepage:Easyrider8!@localhost:5432/nba_lines&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[175]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">run_query</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">query</span><span class="p">,</span><span class="n">con</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[176]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">write_df</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s">&quot;games_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">())</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;-&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">),</span><span class="n">engine</span><span class="p">,</span><span class="n">if_exists</span><span class="o">=</span><span class="s">&#39;append&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="k">False</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[208]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">query</span> <span class="o">=</span> <span class="s">&quot;SELECT * FROM games_20171103 where team like &#39;Chicago&#39;;&quot;</span>
<span class="n">run_query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[208]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>game_id</th>
      <th>game_date</th>
      <th>scrape_time</th>
      <th>team</th>
      <th>opp_team</th>
      <th>spread_line</th>
      <th>spread_odds</th>
      <th>total_line</th>
      <th>total_odds</th>
      <th>fh_spread_line</th>
      <th>fh_spread_odds</th>
      <th>fh_total_line</th>
      <th>fh_total_odds</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>201711030A00:00:03</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:00:03</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1</th>
      <td>201711030A00:00:33</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:00:33</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>2</th>
      <td>201711030A00:01:03</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:01:03</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>3</th>
      <td>201711030A00:01:33</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:01:33</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>4</th>
      <td>201711030A00:02:03</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:02:03</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>5</th>
      <td>201711030A00:02:32</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:02:32</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>6</th>
      <td>201711030A00:03:02</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:03:02</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>7</th>
      <td>201711030A00:03:32</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:03:32</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>8</th>
      <td>201711030A00:04:02</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:04:02</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>9</th>
      <td>201711030A00:04:32</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:04:32</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>10</th>
      <td>201711030A00:05:02</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:05:02</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>11</th>
      <td>201711030A00:05:33</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:05:33</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>12</th>
      <td>201711030A00:06:03</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:06:03</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>13</th>
      <td>201711030A00:06:33</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:06:33</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>14</th>
      <td>201711030A00:07:03</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:07:03</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>15</th>
      <td>201711030A00:07:33</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:07:33</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>16</th>
      <td>201711030A00:08:02</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:08:02</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>17</th>
      <td>201711030A00:08:32</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:08:32</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>18</th>
      <td>201711030A00:09:03</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:09:03</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>19</th>
      <td>201711030A00:09:33</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:09:33</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>20</th>
      <td>201711030A00:10:03</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:10:03</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>21</th>
      <td>201711030A00:10:33</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:10:33</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>22</th>
      <td>201711030A00:11:03</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:11:03</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>23</th>
      <td>201711030A00:11:33</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:11:33</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>24</th>
      <td>201711030A00:12:02</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:12:02</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>25</th>
      <td>201711030A00:12:32</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:12:32</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>26</th>
      <td>201711030A00:13:02</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:13:02</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>27</th>
      <td>201711030A00:13:33</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:13:33</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>28</th>
      <td>201711030A00:14:02</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:14:02</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>29</th>
      <td>201711030A00:14:33</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>00:14:33</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+4.5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1011</th>
      <td>201711030A09:18:03</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:18:03</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1012</th>
      <td>201711030A09:19:03</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:19:03</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1013</th>
      <td>201711030A09:20:03</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:20:03</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1014</th>
      <td>201711030A09:21:02</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:21:02</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1015</th>
      <td>201711030A09:22:03</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:22:03</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1016</th>
      <td>201711030A09:23:03</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:23:03</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1017</th>
      <td>201711030A09:24:03</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:24:03</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1018</th>
      <td>201711030A09:25:03</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:25:03</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1019</th>
      <td>201711030A09:26:03</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:26:03</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1020</th>
      <td>201711030A09:27:04</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:27:04</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1021</th>
      <td>201711030A09:28:04</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:28:04</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1022</th>
      <td>201711030A09:29:04</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:29:04</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1023</th>
      <td>201711030A09:30:03</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:30:03</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1024</th>
      <td>201711030A09:31:03</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:31:03</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1025</th>
      <td>201711030A09:32:03</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:32:03</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1026</th>
      <td>201711030A09:33:03</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:33:03</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1027</th>
      <td>201711030A09:34:04</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:34:04</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1028</th>
      <td>201711030A09:35:03</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:35:03</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1029</th>
      <td>201711030A09:36:03</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:36:03</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1030</th>
      <td>201711030A09:37:03</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:37:03</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1031</th>
      <td>201711030A09:38:02</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:38:02</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1032</th>
      <td>201711030A09:39:02</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:39:02</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1033</th>
      <td>201711030A09:40:03</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:40:03</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1034</th>
      <td>201711030A09:41:03</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:41:03</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1035</th>
      <td>201711030A09:42:02</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:42:02</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1036</th>
      <td>201711030A09:43:02</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:43:02</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1037</th>
      <td>201711030A09:44:03</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:44:03</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1038</th>
      <td>201711030A09:45:02</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:45:02</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1039</th>
      <td>201711030A09:46:03</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:46:03</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
    <tr>
      <th>1040</th>
      <td>201711030A09:47:02</td>
      <td>201711030</td>
      <td>20171103</td>
      <td>09:47:02</td>
      <td>Chicago</td>
      <td>Orlando</td>
      <td>+8.5</td>
      <td>-110</td>
      <td>205</td>
      <td>-110</td>
      <td>+5</td>
      <td>-110</td>
      <td>103</td>
      <td>-115</td>
    </tr>
  </tbody>
</table>
<p>1041 rows × 14 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

</div>
</div>
</div>

</div>